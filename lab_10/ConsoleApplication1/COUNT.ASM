;Составить подпрограмму с именем Count типа
;      function (const S: LONGWORD; L:LONGWORD):INTEGER;
;возвращающую число единиц битовой строки S длины L.
.386
.model FLAT,C
PUBLIC COUNT
.DATA 
S1 	DD 00001111000011110000111100001111B,1010101B 
.CODE
COUNT:

					; по соглашениям
	PUSH EBP		; сохранение значение предыдущей функции 
	MOV EBP,ESP		; записываем текущую позицию в стеке 
	PUSH EBX		; сохраняем прежние

	
	XOR EAX,EAX		  ; обнуление EAX( счетчик единиц)
	MOV EBX,[EBP+8]   ; Заносим адрес строки S, со смещение 12 (начало слова)
	MOV	ECX,[EBP+12]  ; Длина строки
	
	MOV	EDX,0         ; Адресация по битам (хвост слова)
	MOV EDI,0
	
CC:
	BT [EBX],EDX ; Проверка бита строки с индексом EDX [0..31], Флаг CF 
	JNC NO		 ; Просткакиваем увеличение счетчика
	INC EAX		 ; Увеличиваем счетчик на 1
NO:	
	INC EDX		 ; сдвиг индекса
	LOOP CC
	
	; выход из функции по правилам паскаля
	
	POP EBX
	MOV ESP,EBP
	POP EBP
	RET 8
END
