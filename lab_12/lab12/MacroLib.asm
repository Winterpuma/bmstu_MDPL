.386
.model FLAT,C

public START

.CODE
START PROC

PUSHR MACRO RG
	IRP REG, <RG>
		IFIDN <REG>, <F>
			PUSHF
		ELSE
			PUSH REG
		ENDIF
	ENDM
ENDM   

POPR MACRO RG
	IRP REG, <RG>
		IFIDN <REG>, <F>
			POPF
		ELSE
			POP REG
		ENDIF
	ENDM
ENDM 

PUSHR <ESI,EDI,EBX,EBP,F>
POPR <F,EBP,EBX,EDI,ESI>

RET
START ENDP
END